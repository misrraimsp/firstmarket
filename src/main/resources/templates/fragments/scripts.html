<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      lang="en">

    <body>

        <!-- Enable all tooltips in the document -->
        <script th:fragment="enableTooltips">
            $(document).ready(function(){
                $('[data-toggle="tooltip"]').tooltip();
            });
        </script>

        <!-- Disable form submissions if there are invalid fields -->
        <script th:fragment="disableFormSubmissionOnInvalidField">
            (function() {
                'use strict';
                window.addEventListener('load', function() {
                    // Get the forms we want to add validation styles to
                    var forms = document.getElementsByClassName('needs-validation');
                    // Loop over them and prevent submission
                    var validation = Array.prototype.filter.call(forms, function(form) {
                        form.addEventListener('submit', function(event) {
                            if (form.checkValidity() === false) {
                                event.preventDefault();
                                event.stopPropagation();
                            }
                            form.classList.add('was-validated');
                        }, false);
                    });
                }, false);
            })();
        </script>

        <!-- always set newPasswordConfirm pattern equals to newPassword value -->
        <script th:fragment="matchingPasswords">
            document.addEventListener("DOMContentLoaded", function() {
                document.getElementById("newPassword").addEventListener("change", function() {
                    document.getElementById("newPasswordConfirm").pattern = document.getElementById("newPassword").value;
                }, false);
            }, false);
        </script>

        <!-- Checkbox based switch to enable/disable two input tags mutexly.
            checkbox.checked TRUE:  input1 disabled, input2 enabled
            otherwise:              input1 enabled, input2 disabled
        -->
        <script th:fragment="binaryInputSwitch">
            function binaryInputSwitch() {
                if (document.getElementById('switch').checked == true) {
                    document.getElementById("input1").disabled = true;
                    document.getElementById("input2").disabled = false;
                }
                else {
                    document.getElementById("input1").disabled = false;
                    document.getElementById("input2").disabled = true;
                }
            }
        </script>

        <!-- computes the checksum digit and alerts if an error is detected -->
        <script th:fragment="isbnChecksum">
            document.addEventListener("DOMContentLoaded", function() {
                document.getElementById("isbnForm").addEventListener('submit', function() {
                    var isbn = document.getElementById("isbn");
                    if (isbn.checkValidity()) {
                        // Remove non ISBN digits, then split into an array
                        var chars = isbn.value.replace(/[- ]|^ISBN(?:-1[03])?:?/g, "").split("");
                        // Remove the final ISBN digit from `chars`, and assign it to `last`
                        var last = chars.pop();
                        var sum = 0;
                        var check, i;
                        if (chars.length == 9) {
                            // Compute the ISBN-10 check digit
                            chars.reverse();
                            for (i = 0; i < chars.length; i++) {
                                sum += (i + 2) * parseInt(chars[i], 10);
                            }
                            check = 11 - (sum % 11);
                            if (check == 10) {
                                check = "X";
                            } else if (check == 11) {
                                check = "0";
                            }
                        } else {
                            // Compute the ISBN-13 check digit
                            for (i = 0; i < chars.length; i++) {
                                sum += (i % 2 * 2 + 1) * parseInt(chars[i], 10);
                            }
                            check = 10 - (sum % 10);
                            if (check == 10) {
                                check = "0";
                            }
                        }
                        if (check != last) {
                            alert("Error: Invalid ISBN checksum digit (" + last + "). Try with (" + check + ")");
                            isbn.focus();
                            isbn.value = isbn.value.substring(0, isbn.value.length - 1);
                        }
                    }
                }, false);
            }, false);
        </script>

        <!-- Este script permite mostrar u ocultar din치micamente diferentes autores (m치ximo 5).
             Adem치s permite que cuando se detecte un error en el lado del servidor se muestren
             los campos implicados autom치ticamente (simulando el evento 'click()')

             This script allows to dynamically show or hide different authors (maximum 5).
             It also allows the fields involved on a server side error to be displayed
             automatically by properly simulating the 'click ()' event.
         -->
        <script th:fragment="manageAuthors">
            $(document).ready(function(){

                var speed = 250;

                $("#showAuthor1").click(function(){
                    $("#showAuthor1").hide(speed);
                    $("#author1").show(speed);
                    $("#hideAuthor1").show(speed);
                    $("#showAuthor2").show(speed);
                });

                $("#hideAuthor1").click(function(){
                    $("#showAuthor2").hide(speed);
                    $("#hideAuthor1").hide(speed);
                    $("#author1").hide(speed);
                    $("#authorFirstName1").val("");
                    $("#authorLastName1").val("");
                    $("#showAuthor1").show(speed);
                });

                $("#showAuthor2").click(function(){
                    $("#showAuthor2").hide(speed);
                    $("#hideAuthor1").hide(speed);
                    $("#author2").show(speed);
                    $("#showAuthor3").show(speed);
                    $("#hideAuthor2").show(speed);
                });

                $("#hideAuthor2").click(function(){
                    $("#showAuthor3").hide(speed);
                    $("#hideAuthor2").hide(speed);
                    $("#author2").hide(speed);
                    $("#authorFirstName2").val("");
                    $("#authorLastName2").val("");
                    $("#showAuthor2").show(speed);
                    $("#hideAuthor1").show(speed);
                });

                $("#showAuthor3").click(function(){
                    $("#showAuthor3").hide(speed);
                    $("#hideAuthor2").hide(speed);
                    $("#author3").show(speed);
                    $("#showAuthor4").show(speed);
                    $("#hideAuthor3").show(speed);

                });

                $("#hideAuthor3").click(function(){
                    $("#showAuthor4").hide(speed);
                    $("#hideAuthor3").hide(speed);
                    $("#author3").hide(speed);
                    $("#authorFirstName3").val("");
                    $("#authorLastName3").val("");
                    $("#showAuthor3").show(speed);
                    $("#hideAuthor2").show(speed);
                });

                $("#showAuthor4").click(function(){
                    $("#showAuthor4").hide(speed);
                    $("#hideAuthor3").hide(speed);
                    $("#author4").show(speed);
                    $("#hideAuthor4").show(speed);
                });

                $("#hideAuthor4").click(function(){
                    $("#hideAuthor4").hide(speed);
                    $("#author4").hide(speed);
                    $("#authorFirstName4").val("");
                    $("#authorLastName4").val("");
                    $("#showAuthor4").show(speed);
                    $("#hideAuthor3").show(speed);
                });

                if (document.getElementById('authorFirstName4').value != "" || document.getElementById('authorLastName4').value != "") {
                    document.getElementById('showAuthor1').click();
                    document.getElementById('showAuthor2').click();
                    document.getElementById('showAuthor3').click();
                    document.getElementById('showAuthor4').click();
                }
                else {
                    if (document.getElementById('authorFirstName3').value != "" || document.getElementById('authorLastName3').value != "") {
                        document.getElementById('showAuthor1').click();
                        document.getElementById('showAuthor2').click();
                        document.getElementById('showAuthor3').click();
                    }
                    else {
                        if (document.getElementById('authorFirstName2').value != "" || document.getElementById('authorLastName2').value != "") {
                            document.getElementById('showAuthor1').click();
                            document.getElementById('showAuthor2').click();
                        }
                        else {
                            if (document.getElementById('authorFirstName1').value != "" || document.getElementById('authorLastName1').value != "") {
                                document.getElementById('showAuthor1').click();
                            }
                        }
                    }
                }

            });
        </script>

    </body>

</html>